CREATE ALGORITHM=UNDEFINED VIEW `lastmile_dataportal`.`view_dataentry` AS select 'tbl_data_fhw_sch_sickchild' AS `tableName`,year(`lastmile_db`.`tbl_data_fhw_sch_sickchild`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_fhw_sch_sickchild`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_fhw_sch_sickchild`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_fhw_sch_sickchild`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_fhw_sch_sickchild` group by year(`lastmile_db`.`tbl_data_fhw_sch_sickchild`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_fhw_sch_sickchild`.`meta_DE_date`) union select 'tbl_data_prg_trl_trainingledger' AS `tableName`,year(`lastmile_db`.`tbl_data_prg_trl_trainingledger`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_prg_trl_trainingledger`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_prg_trl_trainingledger`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_prg_trl_trainingledger`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_prg_trl_trainingledger` group by year(`lastmile_db`.`tbl_data_prg_trl_trainingledger`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_prg_trl_trainingledger`.`meta_DE_date`) union select 'tbl_data_prg_chv_gchvquestionnaire' AS `tableName`,year(`lastmile_db`.`tbl_data_prg_chv_gchvquestionnaire`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_prg_chv_gchvquestionnaire`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_prg_chv_gchvquestionnaire`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_prg_chv_gchvquestionnaire`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_prg_chv_gchvquestionnaire` group by year(`lastmile_db`.`tbl_data_prg_chv_gchvquestionnaire`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_prg_chv_gchvquestionnaire`.`meta_DE_date`) union select 'tbl_data_fhw_sst_sicknessscreening' AS `tableName`,year(`lastmile_db`.`tbl_data_fhw_sst_sicknessscreening`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_fhw_sst_sicknessscreening`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_fhw_sst_sicknessscreening`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_fhw_sst_sicknessscreening`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_fhw_sst_sicknessscreening` group by year(`lastmile_db`.`tbl_data_fhw_sst_sicknessscreening`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_fhw_sst_sicknessscreening`.`meta_DE_date`) union select 'tbl_data_fhw_reg_registration' AS `tableName`,year(`lastmile_db`.`tbl_data_fhw_reg_registration`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_fhw_reg_registration`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_fhw_reg_registration`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_fhw_reg_registration`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_fhw_reg_registration` group by year(`lastmile_db`.`tbl_data_fhw_reg_registration`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_fhw_reg_registration`.`meta_DE_date`) union select 'tbl_data_fhw_mat_malariaassessment' AS `tableName`,year(`lastmile_db`.`tbl_data_fhw_mat_malariaassessment`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_fhw_mat_malariaassessment`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_fhw_mat_malariaassessment`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_fhw_mat_malariaassessment`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_fhw_mat_malariaassessment` group by year(`lastmile_db`.`tbl_data_fhw_mat_malariaassessment`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_fhw_mat_malariaassessment`.`meta_DE_date`) union select 'tbl_data_fhw_kpi_kpiassessment' AS `tableName`,year(`lastmile_db`.`tbl_data_fhw_kpi_kpiassessment`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_fhw_kpi_kpiassessment`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_fhw_kpi_kpiassessment`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_fhw_kpi_kpiassessment`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_fhw_kpi_kpiassessment` group by year(`lastmile_db`.`tbl_data_fhw_kpi_kpiassessment`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_fhw_kpi_kpiassessment`.`meta_DE_date`) union select 'tbl_data_fhw_ees_ebolaeducationscreening' AS `tableName`,year(`lastmile_db`.`tbl_data_fhw_ees_ebolaeducationscreening`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_fhw_ees_ebolaeducationscreening`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_fhw_ees_ebolaeducationscreening`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_fhw_ees_ebolaeducationscreening`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_fhw_ees_ebolaeducationscreening` group by year(`lastmile_db`.`tbl_data_fhw_ees_ebolaeducationscreening`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_fhw_ees_ebolaeducationscreening`.`meta_DE_date`) union select 'tbl_data_fhw_bdm_movements' AS `tableName`,year(`lastmile_db`.`tbl_data_fhw_bdm_movements`.`meta_DE_date`) AS `deYear`,month(`lastmile_db`.`tbl_data_fhw_bdm_movements`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_db`.`tbl_data_fhw_bdm_movements`.`meta_QA_init` = '') or isnull(`lastmile_db`.`tbl_data_fhw_bdm_movements`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_db`.`tbl_data_fhw_bdm_movements` group by year(`lastmile_db`.`tbl_data_fhw_bdm_movements`.`meta_DE_date`),month(`lastmile_db`.`tbl_data_fhw_bdm_movements`.`meta_DE_date`) union select 'staging_birthsDeathsMovementsStep1' AS `tableName`,year(`lastmile_chwdb`.`staging_birthsdeathsmovementsstep1`.`meta_DE_date`) AS `deYear`,month(`lastmile_chwdb`.`staging_birthsdeathsmovementsstep1`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_chwdb`.`staging_birthsdeathsmovementsstep1`.`meta_QA_init` = '') or isnull(`lastmile_chwdb`.`staging_birthsdeathsmovementsstep1`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_chwdb`.`staging_birthsdeathsmovementsstep1` group by year(`lastmile_chwdb`.`staging_birthsdeathsmovementsstep1`.`meta_DE_date`),month(`lastmile_chwdb`.`staging_birthsdeathsmovementsstep1`.`meta_DE_date`) union select 'staging_registrationStep1' AS `tableName`,year(`lastmile_chwdb`.`staging_registrationstep1`.`meta_DE_date`) AS `deYear`,month(`lastmile_chwdb`.`staging_registrationstep1`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_chwdb`.`staging_registrationstep1`.`meta_QA_init` = '') or isnull(`lastmile_chwdb`.`staging_registrationstep1`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_chwdb`.`staging_registrationstep1` group by year(`lastmile_chwdb`.`staging_registrationstep1`.`meta_DE_date`),month(`lastmile_chwdb`.`staging_registrationstep1`.`meta_DE_date`) union select 'staging_trainingResultsRecordStep1' AS `tableName`,year(`lastmile_chwdb`.`staging_trainingresultsrecordstep1`.`meta_DE_date`) AS `deYear`,month(`lastmile_chwdb`.`staging_trainingresultsrecordstep1`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_chwdb`.`staging_trainingresultsrecordstep1`.`meta_QA_init` = '') or isnull(`lastmile_chwdb`.`staging_trainingresultsrecordstep1`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_chwdb`.`staging_trainingresultsrecordstep1` group by year(`lastmile_chwdb`.`staging_trainingresultsrecordstep1`.`meta_DE_date`),month(`lastmile_chwdb`.`staging_trainingresultsrecordstep1`.`meta_DE_date`) union select 'staging_chwMonthlyServiceReportStep1' AS `tableName`,year(`lastmile_chwdb`.`staging_chwmonthlyservicereportstep1`.`meta_DE_date`) AS `deYear`,month(`lastmile_chwdb`.`staging_chwmonthlyservicereportstep1`.`meta_DE_date`) AS `deMonth`,count(0) AS `numRecords`,sum(if(((`lastmile_chwdb`.`staging_chwmonthlyservicereportstep1`.`meta_QA_init` = '') or isnull(`lastmile_chwdb`.`staging_chwmonthlyservicereportstep1`.`meta_QA_init`)),0,1)) AS `numQA` from `lastmile_chwdb`.`staging_chwmonthlyservicereportstep1` group by year(`lastmile_chwdb`.`staging_chwmonthlyservicereportstep1`.`meta_DE_date`),month(`lastmile_chwdb`.`staging_chwmonthlyservicereportstep1`.`meta_DE_date`) order by `deYear` desc,`deMonth` desc;
